-include $(PVI)/configure/CONFIG_SITE

# Note in these rules, we create the target in-source and then copy it to the build
# target. This is so that the resulting changes can be commited and used in builds
# without PVI available `$(@F)` is the file-within-directory part of the file name of
# the target, so `../$(@F)` is the source location of the file we want to generate
# See: https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html

ifdef BIN_PVI

# Rules

## Rule to create a Parameters template
%Parameters.template: $(TOP)/pvi/%.pvi.producer.yaml
	$(BIN_PVI) produce ../$(@F) $<
	cp ../$(@F) $@

## Rule to create a ParamSet header
%ParamSet.h: $(TOP)/pvi/%.pvi.producer.yaml
	$(BIN_PVI) produce ../$(@F) $<
	cp ../$(@F) $@

endif # BIN_PVI
